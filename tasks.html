<!DOCTYPE html>
<html>
    <head>
        <title>Tarefas</title>
        <link href="https://fonts.googleapis.com/css?family=Bangers|Lobster|Rock+Salt" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/form.css">
    </head>
    <body>
        <div class="container">
            <div class="row">
                <nav class="navbar">
                <div class="container-fluid">
                    <div class="cabecalho">
                    <!-- <button class="btn btn-default navbar-btn">Deslogar</button> -->
                    </div>
                    <div class="cabecalho navbar-header">
                        <h1 id="saudacao">Seja bem vindo,  </h1>
                    </div>
                </div>
                </nav>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-4"></div>
                        <div class="col-md-8">
                        <form class="" action='tasks.php' method='GET'>
                            <div class="form-group">
                                <label class="control-label" for="tarefa">Tarefa: </label>
                                <input class="form-control" type="text" name="tarefa">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="data">Data: </label>
                                <input class="form-control" type="text" name="data">
                            </div>
                            <button id="add-tarefa" class="btn btn-primary" type="submit" >Salvar</button>
                        </form>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-10">
                        <div class="panel panel-default">
                            <div class="panel-heading"><label class="texto-centro">Lista de Tarefas</label></div>
                            <div class="panel-body">
                                <table id="listaTarefas">
                                  <tbody>
                                    <tr>
                                      <th>Nome da tarefa</th><th>Data da tarefa</th>
                                    </tr>
                                  </tbody>
                                </table>
                            </div>
                        </div>
                        </div>
                        <div class="col-md-2"></div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
        <script>
            window.jQuery || document.write('<script src="js/jquery-3.2.1.min.js"><\/script>');
        </script>
        <script src="js/scripts.js"></script>
        <script src="js/TaskService.js"></script>
        <script>
            $(document).ready(function(){
                var user = parseQueryString(window.location.search.slice(1));

                $('#saudacao').append(user.name);

                var taskService = new TaskService();
                var taskLista = taskService.getTasksByUserId(user.id);

                var addRow = function(task) {

                  var newRow = $("<tr>");
                  var cols = "";

                  cols += '<td>' + task.title + '</td>';
                  cols += '<td>' + task.date + '</td>';
                  cols += '<td>';
                  cols += '<button onclick="RemoveTableRow(this)" type="button">Remover</button>';
                  cols += '</td>';

                  newRow.append(cols);
                  $("#listaTarefas").append(newRow);

                  return false;
                };

                function listarTarefas(taskLista) {
                  taskLista.forEach(function(task, index){
                    addRow(task)
                  })
                };

                listarTarefas(taskLista);
            });
        </script>
    </body>
</html>
